{"version":3,"file":"ifvisible.js","sources":["../../src/Events.ts","../../src/Timer.ts","../../src/ifvisible.ts"],"sourcesContent":["export namespace Events {\n  const store = {};\n  let setListener: Function;\n\n  export function attach (event: string, callback: Function) {\n    if (!store[event]) {\n      store[event] = [];\n    }\n    store[event].push(callback);\n  }\n\n  export function fire (event: string, args = []) {\n    if (store[event]) {\n      store[event].forEach(callback => {\n        callback(...args);\n      });\n    }\n  }\n\n  export function remove (event: string, callback?: Function) {\n    if (!callback) {\n      delete store[event];\n    }\n    if (store[event]) {\n      store[event] = store[event].filter(savedCallback => {\n        return callback !== savedCallback;\n      });\n    }\n  }\n\n  export function dom (element: any, event: string, callback: Function) {\n    if (!setListener) {\n      if (element.addEventListener) {\n        setListener = (el, ev, fn) => {\n          return el.addEventListener(ev, fn, false);\n        };\n      } else if (typeof element.attachEvent === 'function') {\n        setListener = (el, ev, fn) => {\n          return el.attachEvent(`on${ev}`, fn, false);\n        };\n      } else {\n        setListener = (el, ev, fn) => {\n          // eslint-disable-next-line no-return-assign, no-param-reassign\n          return el[`on${ev}`] = fn;\n        };\n      }\n    }\n    return setListener(element, event, callback);\n  }\n}\n\n// export default Events;\n","import { IfVisible, STATUS_ACTIVE } from './ifvisible';\n\nexport default class Timer {\n  private token: number;\n\n  stopped: boolean = false;\n\n  constructor (private ifvisible: IfVisible,\n    private seconds: number,\n    private callback: Function) {\n    this.start();\n\n    this.ifvisible.on('statusChanged', (data: any) => {\n      if (this.stopped === false) {\n        if (data.status === STATUS_ACTIVE) {\n          this.start();\n        } else {\n          this.pause();\n        }\n      }\n    });\n  }\n\n  private start () {\n    this.stopped = false;\n    clearInterval(this.token);\n    this.token = setInterval(this.callback, this.seconds * 1000);\n  }\n\n  stop () {\n    this.stopped = true;\n    clearInterval(this.token);\n  }\n\n  resume () {\n    this.start();\n  }\n\n  pause () {\n    this.stop();\n  }\n}\n","import { Events } from './Events';\nimport Timer from './Timer';\n\nexport const STATUS_ACTIVE = 'active';\nexport const STATUS_IDLE = 'idle';\nexport const STATUS_HIDDEN = 'hidden';\nlet DOC_HIDDEN: string;\nlet VISIBILITY_CHANGE_EVENT: string;\n\nexport interface IIdleInfo {\n  isIdle: boolean;\n  idleFor: number;\n  timeLeft: number;\n  timeLeftPer: number;\n}\n\n// eslint-disable-next-line func-names\nexport const IE = (function () {\n  let undef;\n  let v = 3;\n  const div = document.createElement('div');\n  const all = div.getElementsByTagName('i');\n\n  // eslint-disable-next-line no-cond-assign\n  while (\n    // eslint-disable-next-line no-plusplus, no-sequences\n    div.innerHTML = `<!--[if gt IE ${++v}]><i></i><![endif]-->`,\n    all[0]\n  );\n\n  return v > 4 ? v : undef;\n}());\n\nexport class IfVisible {\n  status: string = STATUS_ACTIVE;\n\n  private timers: NodeJS.Timeout[] = [];\n\n  private idleTime: number = 30000;\n\n  private idleStartedTime: number;\n\n  private isLegacyModeOn = false;\n\n\n  constructor (private root, private doc) {\n    // Find correct browser events\n    if (this.doc.hidden !== undefined) {\n      DOC_HIDDEN = 'hidden';\n      VISIBILITY_CHANGE_EVENT = 'visibilitychange';\n    } else if (this.doc.mozHidden !== undefined) {\n      DOC_HIDDEN = 'mozHidden';\n      VISIBILITY_CHANGE_EVENT = 'mozvisibilitychange';\n    } else if (this.doc.msHidden !== undefined) {\n      DOC_HIDDEN = 'msHidden';\n      VISIBILITY_CHANGE_EVENT = 'msvisibilitychange';\n    } else if (this.doc.webkitHidden !== undefined) {\n      DOC_HIDDEN = 'webkitHidden';\n      VISIBILITY_CHANGE_EVENT = 'webkitvisibilitychange';\n    }\n\n    if (DOC_HIDDEN === undefined) {\n      this.legacyMode();\n    } else {\n      const trackChange = () => {\n        if (this.doc[DOC_HIDDEN]) {\n          this.blur();\n        } else {\n          this.focus();\n        }\n      };\n      trackChange(); // get initial status\n      Events.dom(this.doc, VISIBILITY_CHANGE_EVENT, trackChange);\n    }\n    this.startIdleTimer();\n    this.trackIdleStatus();\n  }\n\n  legacyMode () {\n    // it's already on\n    if (this.isLegacyModeOn) { return; }\n\n    let BLUR_EVENT = 'blur';\n    const FOCUS_EVENT = 'focus';\n\n    if (IE < 9) {\n      BLUR_EVENT = 'focusout';\n    }\n\n    Events.dom(this.root, BLUR_EVENT, () => {\n      return this.blur();\n    });\n\n    Events.dom(this.root, FOCUS_EVENT, () => {\n      return this.focus();\n    });\n\n    this.isLegacyModeOn = true;\n  }\n\n  startIdleTimer (event?: Event) {\n    // Prevents Phantom events.\n    // @see https://github.com/serkanyersen/ifvisible.js/pull/37\n    if (event instanceof MouseEvent && event.movementX === 0 && event.movementY === 0) {\n      return;\n    }\n\n    this.timers.map(clearTimeout);\n    this.timers.length = 0; // clear the array\n\n    if (this.status === STATUS_IDLE) {\n      this.wakeup();\n    }\n\n    this.idleStartedTime = +(new Date());\n\n    this.timers.push(setTimeout(() => {\n      if (this.status === STATUS_ACTIVE || this.status === STATUS_HIDDEN) {\n        return this.idle();\n      }\n    }, this.idleTime));\n  }\n\n  trackIdleStatus () {\n    Events.dom(this.doc, 'mousemove', this.startIdleTimer.bind(this));\n    Events.dom(this.doc, 'mousedown', this.startIdleTimer.bind(this));\n    Events.dom(this.doc, 'keyup', this.startIdleTimer.bind(this));\n    Events.dom(this.doc, 'touchstart', this.startIdleTimer.bind(this));\n    Events.dom(this.root, 'scroll', this.startIdleTimer.bind(this));\n    // When page is focus without any event, it should not be idle.\n    this.focus(this.startIdleTimer.bind(this));\n  }\n\n  on (event: string, callback: (data: any) => any): IfVisible {\n    Events.attach(event, callback);\n    return this;\n  }\n\n  off (event: string, callback?: any): IfVisible {\n    Events.remove(event, callback);\n    return this;\n  }\n\n  setIdleDuration (seconds: number): IfVisible {\n    this.idleTime = seconds * 1000;\n    this.startIdleTimer();\n    return this;\n  }\n\n  getIdleDuration (): number {\n    return this.idleTime;\n  }\n\n  getIdleInfo (): IIdleInfo {\n    const now = +(new Date());\n    let res: IIdleInfo;\n    if (this.status === STATUS_IDLE) {\n      res = {\n        isIdle: true,\n        idleFor: now - this.idleStartedTime,\n        timeLeft: 0,\n        timeLeftPer: 100,\n      };\n    } else {\n      const timeLeft = (this.idleStartedTime + this.idleTime) - now;\n      res = {\n        isIdle: false,\n        idleFor: now - this.idleStartedTime,\n        timeLeft,\n        timeLeftPer: parseFloat((100 - (timeLeft * 100 / this.idleTime)).toFixed(2)),\n      };\n    }\n    return res;\n  }\n\n  idle (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('idle', callback);\n    } else {\n      this.status = STATUS_IDLE;\n      Events.fire('idle');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  blur (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('blur', callback);\n    } else {\n      this.status = STATUS_HIDDEN;\n      Events.fire('blur');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  focus (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('focus', callback);\n    } else if (this.status !== STATUS_ACTIVE) {\n      this.status = STATUS_ACTIVE;\n      Events.fire('focus');\n      Events.fire('wakeup');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  wakeup (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('wakeup', callback);\n    } else if (this.status !== STATUS_ACTIVE) {\n      this.status = STATUS_ACTIVE;\n      Events.fire('wakeup');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  onEvery (seconds: number, callback: Function): Timer {\n    return new Timer(this, seconds, callback);\n  }\n\n  now (check?: string): boolean {\n    if (check !== undefined) {\n      return this.status === check;\n    }\n    return this.status === STATUS_ACTIVE;\n  }\n}\n"],"names":[],"mappings":"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"}