{"version":3,"file":"index.js","sources":["../src/Events.ts","../src/IfVisible.ts","../src/index.ts"],"sourcesContent":["export namespace Events {\n  const store = {};\n  let setListener: Function;\n\n  export function attach (event: string, callback: Function) {\n    if (!store[event]) {\n      store[event] = [];\n    }\n    store[event].push(callback);\n  }\n\n  export function fire (event: string, args = []) {\n    if (store[event]) {\n      store[event].forEach(callback => {\n        callback(...args);\n      });\n    }\n  }\n\n  export function remove (event: string, callback?: Function) {\n    if (!callback) {\n      delete store[event];\n    }\n    if (store[event]) {\n      store[event] = store[event].filter(savedCallback => {\n        return callback !== savedCallback;\n      });\n    }\n  }\n\n  export function dom (element: any, event: string, callback: Function) {\n    if (!setListener) {\n      if (element.addEventListener) {\n        setListener = (el, ev, fn) => {\n          return el.addEventListener(ev, fn, false);\n        };\n      } else if (typeof element.attachEvent === 'function') {\n        setListener = (el, ev, fn) => {\n          return el.attachEvent(`on${ev}`, fn, false);\n        };\n      } else {\n        setListener = (el, ev, fn) => {\n          // eslint-disable-next-line no-return-assign, no-param-reassign\n          return el[`on${ev}`] = fn;\n        };\n      }\n    }\n    return setListener(element, event, callback);\n  }\n}\n\n// export default Events;\n","import { Events } from './Events';\n\nexport const STATUS_ACTIVE = 'active';\nexport const STATUS_IDLE = 'idle';\nexport const STATUS_HIDDEN = 'hidden';\nlet DOC_HIDDEN: string;\nlet VISIBILITY_CHANGE_EVENT: string;\n\nexport interface IIdleInfo {\n  isIdle: boolean;\n  idleFor: number;\n  timeLeft: number;\n  timeLeftPer: number;\n}\n\n// eslint-disable-next-line func-names\nexport const IE = (function () {\n  let undef;\n  let v = 3;\n  const div = document.createElement('div');\n  const all = div.getElementsByTagName('i');\n\n  // eslint-disable-next-line no-cond-assign\n  while (\n    // eslint-disable-next-line no-plusplus, no-sequences\n    div.innerHTML = `<!--[if gt IE ${++v}]><i></i><![endif]-->`,\n    all[0]\n  );\n\n  return v > 4 ? v : undef;\n}());\n\nclass Timer {\n  private token: number;\n\n  stopped: boolean = false;\n\n  constructor (private ifvisible: IfVisible,\n    private seconds: number,\n    private callback: Function) {\n    this.start();\n\n    this.ifvisible.on('statusChanged', (data: any) => {\n      if (this.stopped === false) {\n        if (data.status === STATUS_ACTIVE) {\n          this.start();\n        } else {\n          this.pause();\n        }\n      }\n    });\n  }\n\n  private start () {\n    this.stopped = false;\n    clearInterval(this.token);\n    this.token = setInterval(this.callback, this.seconds * 1000);\n  }\n\n  stop () {\n    this.stopped = true;\n    clearInterval(this.token);\n  }\n\n  resume () {\n    this.start();\n  }\n\n  pause () {\n    this.stop();\n  }\n}\n\nexport class IfVisible {\n  status: string = STATUS_ACTIVE;\n\n  private timers: NodeJS.Timeout[] = [];\n\n  private idleTime: number = 30000;\n\n  private idleStartedTime: number;\n\n  private isLegacyModeOn = false;\n\n\n  constructor (private root, private doc) {\n    // Find correct browser events\n    if (this.doc.hidden !== undefined) {\n      DOC_HIDDEN = 'hidden';\n      VISIBILITY_CHANGE_EVENT = 'visibilitychange';\n    } else if (this.doc.mozHidden !== undefined) {\n      DOC_HIDDEN = 'mozHidden';\n      VISIBILITY_CHANGE_EVENT = 'mozvisibilitychange';\n    } else if (this.doc.msHidden !== undefined) {\n      DOC_HIDDEN = 'msHidden';\n      VISIBILITY_CHANGE_EVENT = 'msvisibilitychange';\n    } else if (this.doc.webkitHidden !== undefined) {\n      DOC_HIDDEN = 'webkitHidden';\n      VISIBILITY_CHANGE_EVENT = 'webkitvisibilitychange';\n    }\n\n    if (DOC_HIDDEN === undefined) {\n      this.legacyMode();\n    } else {\n      const trackChange = () => {\n        if (this.doc[DOC_HIDDEN]) {\n          this.blur();\n        } else {\n          this.focus();\n        }\n      };\n      trackChange(); // get initial status\n      Events.dom(this.doc, VISIBILITY_CHANGE_EVENT, trackChange);\n    }\n    this.startIdleTimer();\n    this.trackIdleStatus();\n  }\n\n  legacyMode () {\n    // it's already on\n    if (this.isLegacyModeOn) { return; }\n\n    let BLUR_EVENT = 'blur';\n    const FOCUS_EVENT = 'focus';\n\n    if (IE < 9) {\n      BLUR_EVENT = 'focusout';\n    }\n\n    Events.dom(this.root, BLUR_EVENT, () => {\n      return this.blur();\n    });\n\n    Events.dom(this.root, FOCUS_EVENT, () => {\n      return this.focus();\n    });\n\n    this.isLegacyModeOn = true;\n  }\n\n  startIdleTimer (event?: Event) {\n    // Prevents Phantom events.\n    if (event instanceof MouseEvent && event.movementX === 0 && event.movementY === 0) {\n      return;\n    }\n\n    this.timers.map(clearTimeout);\n    this.timers.length = 0; // clear the array\n\n    if (this.status === STATUS_IDLE) {\n      this.wakeup();\n    }\n\n    this.idleStartedTime = +(new Date());\n\n    this.timers.push(setTimeout(() => {\n      if (this.status === STATUS_ACTIVE || this.status === STATUS_HIDDEN) {\n        return this.idle();\n      }\n    }, this.idleTime));\n  }\n\n  trackIdleStatus () {\n    Events.dom(this.doc, 'mousemove', this.startIdleTimer.bind(this));\n    Events.dom(this.doc, 'mousedown', this.startIdleTimer.bind(this));\n    Events.dom(this.doc, 'keyup', this.startIdleTimer.bind(this));\n    Events.dom(this.doc, 'touchstart', this.startIdleTimer.bind(this));\n    Events.dom(this.root, 'scroll', this.startIdleTimer.bind(this));\n    // When page is focus without any event, it should not be idle.\n    this.focus(this.startIdleTimer.bind(this));\n  }\n\n  on (event: string, callback: (data: any) => any): IfVisible {\n    Events.attach(event, callback);\n    return this;\n  }\n\n  off (event: string, callback?: any): IfVisible {\n    Events.remove(event, callback);\n    return this;\n  }\n\n  setIdleDuration (seconds: number): IfVisible {\n    this.idleTime = seconds * 1000;\n    this.startIdleTimer();\n    return this;\n  }\n\n  getIdleDuration (): number {\n    return this.idleTime;\n  }\n\n  getIdleInfo (): IIdleInfo {\n    const now = +(new Date());\n    let res: IIdleInfo;\n    if (this.status === STATUS_IDLE) {\n      res = {\n        isIdle: true,\n        idleFor: now - this.idleStartedTime,\n        timeLeft: 0,\n        timeLeftPer: 100,\n      };\n    } else {\n      const timeLeft = (this.idleStartedTime + this.idleTime) - now;\n      res = {\n        isIdle: false,\n        idleFor: now - this.idleStartedTime,\n        timeLeft,\n        timeLeftPer: parseFloat((100 - (timeLeft * 100 / this.idleTime)).toFixed(2)),\n      };\n    }\n    return res;\n  }\n\n  idle (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('idle', callback);\n    } else {\n      this.status = STATUS_IDLE;\n      Events.fire('idle');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  blur (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('blur', callback);\n    } else {\n      this.status = STATUS_HIDDEN;\n      Events.fire('blur');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  focus (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('focus', callback);\n    } else if (this.status !== STATUS_ACTIVE) {\n      this.status = STATUS_ACTIVE;\n      Events.fire('focus');\n      Events.fire('wakeup');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  wakeup (callback?: (data: any) => any): IfVisible {\n    if (callback) {\n      this.on('wakeup', callback);\n    } else if (this.status !== STATUS_ACTIVE) {\n      this.status = STATUS_ACTIVE;\n      Events.fire('wakeup');\n      Events.fire('statusChanged', [{ status: this.status }]);\n    }\n    return this;\n  }\n\n  onEvery (seconds: number, callback: Function): Timer {\n    return new Timer(this, seconds, callback);\n  }\n\n  now (check?: string): boolean {\n    if (check !== undefined) {\n      return this.status === check;\n    }\n    return this.status === STATUS_ACTIVE;\n  }\n}\n","import { IfVisible } from './IfVisible';\n\ndeclare let global: any;\n// decide between self vs global depending on the environment\nconst root = (typeof self === 'object' && self.self === self && self)\n             || (typeof global === 'object' && global.global === global && global);\n\n// set library singleton\nexport const ifvisible = new IfVisible(root, document);\n\n// set window singleton (e.g. window.ifvisible)\nif (root) {\n  (root as any).ifvisible = ifvisible;\n}"],"names":[],"mappings":"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"}